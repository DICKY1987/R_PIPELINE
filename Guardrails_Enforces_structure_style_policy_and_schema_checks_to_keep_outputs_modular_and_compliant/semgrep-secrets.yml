# Secret scanning rules for the guardrail pipeline.

rules:
  - id: secret-aws-access-key
    message: "Potential AWS access key detected. Use secure secrets storage."
    severity: ERROR
    languages: [python, typescript, javascript, generic]
    pattern-regex: "AKIA[0-9A-Z]{16}"

  - id: secret-aws-secret-key
    message: "Potential AWS secret key detected."
    severity: ERROR
    languages: [python, typescript, javascript, generic]
    pattern-regex: "(?i)aws(.{0,20})?(secret|access)_key(.{0,20})?=\s*['\"]?[A-Za-z0-9/+=]{40}"

  - id: secret-slack-token
    message: "Slack tokens must not be committed. Rotate the credential immediately."
    severity: ERROR
    languages: [python, typescript, javascript, generic]
    pattern-regex: "xox[aboprs]-[0-9a-zA-Z-]{10,48}"

  - id: secret-private-key
    message: "Private key material detected."
    severity: ERROR
    languages: [generic]
    patterns:
      - pattern: "-----BEGIN PRIVATE KEY-----"

